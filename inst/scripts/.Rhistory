5,  19,  16,  38,
71, 137, 249, 363),
dim = c(2, 2, 3),
dimnames = list(
Smoke.Spouse = c("No", "Yes"),
Studies = c("Cases", "Controls"),
Country = c("Japan", "Great Britain", "United States")))
LungCancer <-
array(c(21, 73,  82,  188,
5,  19,  16,  38,
71, 137, 249, 363),
dim = c(2, 2, 3),
dimnames = list(
Smoke.Spouse = c("No", "Yes"),
Studies = c("Cases", "Controls"),
Country = c("Japan", "Great Britain", "United States")))
mantelhaen.test(LungCancer,correct=F)
mantelhaen.test(ns,correct=F)
ns[,1]
ns[,,1]
LungCancer[,,1]
mantelhaen.test(ns,correct=F)
mantelhaen.test(LungCancer,correct=F)
1/0.7218253
?BreslowDayTest
??BreslowDayTest
apply(ns, 3, odds.ratio)
oddsratio(ns,log=F)
ns<-array(c( 73, 21, 188, 82,
19, 5, 38, 16,
137, 71, 363, 249),
dim =c(2, 2, 3),dimnames =list(SpouseSmoking =c("Yes", "No"),LungCancer =c("Case", "Control"),
Country =c("Japan", "UK", "US")))
ns
ns[,,1]
oddsratio(ns[,,1])
1/oddsratio(ns[,,1])
test = oddsratio(ns[,,1])
test$coefficients
1/test$coefficients
21*188/(73*82)
1/
21*188/(73*82)
1/(21*188/(73*82))
(73*82)/(188*21)
1/1.516211
?mantelhaen.test
ldl <-array(c(18,8,0,0,21,4,2,0,16,30,13,2,17,25,6,0,0,14,28,7,11,35,36,6,0,2,15,22,1,5,14,12),dim =c(4,2,4),dimnames =list( ending=c("<3.4", "3.4-4.1", "4.1-4.9", ">4.9"),group=c("Control", "Treatment"),begining=c("<3.4", "3.4-4.1", "4.1-4.9", ">4.9")))
mantelhaen.test(ldl, exact = T)
mantelhaen.test(ldl, correct = F)
ldl <-array(c(18,8,0,0,21,4,2,0,16,30,13,2,17,25,6,0,0,14,28,7,11,35,36,6,0,2,15,22,1,5,14,12),dim =c(4,2,4),dimnames =list( ending=c("<3.4", "3.4-4.1", "4.1-4.9", ">4.9"),group=c("Control", "Treatment"),begining=c("<3.4", "3.4-4.1", "4.1-4.9", ">4.9")))
ldl
?mantelhaen.test
ldl
mantelhaen.test(ldl, correct = T)
mantelhaen.test(ldl, correct = F)
mantelhaen.test(ldl, exact = T)
mantelhaen.test(ldl, exact = T,correct = F)
mantelhaen.test(ldl)
summary(mantelhaen.test(ldl))
mantelhaen.test(ldl, alternative = "two.sided")
mantelhaen.test(ldl, alternative = "less")
mantelhaen.test(ldl, alternative = "greater")
ldl
ldl
ldl
Rabbits <-
array(c(0, 0, 6, 5,
3, 0, 3, 6,
6, 2, 0, 4,
5, 6, 1, 0,
2, 5, 0, 0),
dim = c(2, 2, 5),
dimnames = list(
Delay = c("None", "1.5h"),
Response = c("Cured", "Died"),
Penicillin.Level = c("1/8", "1/4", "1/2", "1", "4")))
Rabbits
ldl
Rabbits
ldl
ldl = array(c(18,8,0,0,21,4,2,0,16,30,13,2,17,25,6,0,0,14,28,7,11,35,36,6,0,2,15,22,1,5,14,12),dim =c(4,4,2),dimnames =list( ending=c("<3.4", "3.4-4.1", "4.1-4.9", ">4.9"),group=c("Control", "Treatment"),begining=c("<3.4", "3.4-4.1", "4.1-4.9", ">4.9")))
ldl
ldl = array(c(18,8,0,0,21,4,2,0,16,30,13,2,17,25,6,0,0,14,28,7,11,35,36,6,0,2,15,22,1,5,14,12),dim =c(2,4,4),
dimnames =list(                             group=c("Control", "Treatment"),
ending=c("<3.4", "3.4-4.1", "4.1-4.9", ">4.9"),
begining=c("<3.4", "3.4-4.1", "4.1-4.9", ">4.9")))
ldl
mantelhaen.test(ldl)
ldl
mantelhaen.test(ldl)
mantelhaen.test(ldl, correct = F)
test = mantelhaen.test(ldl)
test$data.name
test$method
test$parameter
ldl = array(c(18,8,0,0,21,4,2,0,16,30,13,2,17,25,6,0,0,14,28,7,11,35,36,6,0,2,15,22,1,5,14,12),dim =c(4,4,2),
dimnames =list(
ending=c("<3.4", "3.4-4.1", "4.1-4.9", ">4.9"),
begining=c("<3.4", "3.4-4.1", "4.1-4.9", ">4.9"),
group=c("Control", "Treatment")))
mantelhaen.test(ldl)
mantelhaen.test(ldl, correct = F)
mantelhaen.test(Rabbits, exact = TRUE, alternative = "greater")
mantelhaen.test(ldl, exact = TRUE, alternative = "greater")
ldl = array(c(18,8,0,0,21,4,2,0,16,30,13,2,17,25,6,0,0,14,28,7,11,35,36,6,0,2,15,22,1,5,14,12),dim =c(2,4,4),
dimnames =list(                             group=c("Control", "Treatment"),
ending=c("<3.4", "3.4-4.1", "4.1-4.9", ">4.9"),
begining=c("<3.4", "3.4-4.1", "4.1-4.9", ">4.9")))
mantelhaen.test(ldl, exact = TRUE, alternative = "greater")
Satisfaction <-
as.table(array(c(1, 2, 0, 0, 3, 3, 1, 2,
11, 17, 8, 4, 2, 3, 5, 2,
1, 0, 0, 0, 1, 3, 0, 1,
2, 5, 7, 9, 1, 1, 3, 6),
dim = c(4, 4, 2),
dimnames =
list(Income =
c("<5000", "5000-15000",
"15000-25000", ">25000"),
"Job Satisfaction" =
c("V_D", "L_S", "M_S", "V_S"),
Gender = c("Female", "Male"))))
mantelhaen.test(Satisfaction)
ftable(. ~ Gender + Income, Satisfaction)
Satisfaction <-
as.table(array(c(18,8,0,0,21,4,2,0,16,30,13,2,17,25,6,0,0,14,28,7,11,35,36,6,0,2,15,22,1,5,14,12),
dim = c(2, 4, 4),
dimnames =
list(group=c("Control", "Treatment"),
ending=c("<3.4", "3.4-4.1", "4.1-4.9", ">4.9"),
begining=c("<3.4", "3.4-4.1", "4.1-4.9", ">4.9"))))
Satisfaction
mantelhaen.test(Satisfaction, correct = F)
Satisfaction
Satisfaction <-
as.table(array(
c(18,21,8,4,0,2,0,0,
16,17,30,25,13,6,2,0,
0,11,14,35,28,36,7,6
0,1,2,5,15,14,22,12)
dim = c(2, 4, 4),
dimnames =
list(group=c("Control", "Treatment"),
ending=c("<3.4", "3.4-4.1", "4.1-4.9", ">4.9"),
begining=c("<3.4", "3.4-4.1", "4.1-4.9", ">4.9"))))
Satisfaction <-
as.table(array(
c(18,21,8,4,0,2,0,0,
16,17,30,25,13,6,2,0,
0,11,14,35,28,36,7,6
0,1,2,5,15,14,22,12),
dim = c(2, 4, 4),
dimnames =
list(group=c("Control", "Treatment"),
ending=c("<3.4", "3.4-4.1", "4.1-4.9", ">4.9"),
begining=c("<3.4", "3.4-4.1", "4.1-4.9", ">4.9"))))
c(18,21,8,4,0,2,0,0,
16,17,30,25,13,6,2,0,
0,11,14,35,28,36,7,6
0,1,2,5,15,14,22,12)
c(18,21,8,4,0,2,0,0,
16,17,30,25,13,6,2,0,
0,11,14,35,28,36,7,6,
0,1,2,5,15,14,22,12)
Satisfaction <-
as.table(array(
c(18,21,8,4,0,2,0,0,
16,17,30,25,13,6,2,0,
0,11,14,35,28,36,7,6,
0,1,2,5,15,14,22,12),
dim = c(2, 4, 4),
dimnames =
list(group=c("Control", "Treatment"),
ending=c("<3.4", "3.4-4.1", "4.1-4.9", ">4.9"),
begining=c("<3.4", "3.4-4.1", "4.1-4.9", ">4.9"))))
mantelhaen.test(Satisfaction, correct = F)
mantelhaen.test(Satisfaction, correct = F, exact = T)
mantelhaen.test(Satisfaction, correct = F, exact = T, alternative = "greater")
mantelhaen.test(Satisfaction, correct = F, exact = F, alternative = "greater")
mantelhaen.test(Satisfaction, correct = T, exact = F, alternative = "greater")
beg.labs <-factor(c("<3.4","3.4-4.1","4.1-4.9",">4.9"),levels=c("<3.4","3.4-4.1","4.1-4.9",">4.9"))
end.labs <-factor(c("<3.4","3.4-4.1","4.1-4.9",">4.9"),levels=c("<3.4","3.4-4.1","4.1-4.9",">4.9"))
group.labs <-factor(c("Control","Treatment"),levels=c("Control","Treatment"))
mantelhaen.test(x=group,y=ending,z=begining,correct = TRUE)
mantelhaen.test(x=group.labs,y=ending,z=begining,correct = TRUE)
mantelhaen.test(x=group.labs,y=end.labs,z=beg.labs,correct = TRUE)
group.labs
ldl <-array(c(18,8,0,0,21,4,2,0,16,30,13,2,17,25,6,0,0,14,28,7,11,35,36,6,0,2,15,22,1,5,14,12),dim =c(4,2,4),dimnames =list( ending=c("<3.4", "3.4-4.1", "4.1-4.9", ">4.9"),group=c("Control", "Treatment"),begining=c("<3.4", "3.4-4.1", "4.1-4.9", ">4.9")))
mantelhaen.test(ldl, overall = T)
CMHtest(ldl, overall = T)
library(vcdExtra)
CMHtest(ldl, overall = T)
1/0.793
1/0.98
kyph = NULL
kyph$age = c(12, 15, 42, 52, 59, 73, 82, 91, 96, 105, 114, 120, 121, 128, 130, 139, 139, 157,
1, 1, 2, 8, 11, 18, 22, 31, 37, 61, 72, 81, 97, 112, 118, 127, 131, 140, 151, 159, 177, 206)
kyph$kyph = c(rep(1,18),rep(0,22))
glm(kyph ~ age,data=kyph,family=binomial(link="logit"))
fit1 = glm(kyph ~ age,data=kyph,family=binomial(link="logit"))
summary(fit1`)
summary(fit1)
?I
fit2 = glm(kyph ~ age + age*age,data=kyph,family=binomial(link="logit"))
summary(fit2)
fit2 = glm(kyph ~ age + (age*age),data=kyph,family=binomial(link="logit"))
summary(fit2)
fit2 = glm(kyph ~ age + age^2,data=kyph,family=binomial(link="logit"))
summary(fit2)
fit2
kyph$age2 = kyph$age^2
fit2 = glm(kyph ~ age + age2,data=kyph,family=binomial(link="logit"))
summary(fit2)
I(kyph$age2)
glm(kyph~age+I(age*age),data=kyph,family=binomial(link="logit"))
summary(fit2)
glm(kyph~age+I(age*age),data=kyph,family=binomial(link="logit"))
rbinom(n = 10)
rbinom(size = 10)
rbinom(n = 1, size = 10)
rbinom(n = 1, size = 10, prob = 0.5)
rbinom(n = 10, size = 1, prob = 0.5)
rbinom(n = 10, size = 1, prob = 0.1)
rbinom(n = 10, size = 1, prob = 0.1)
p = rbinom(n = 10, size = 1, prob = 0.1)
p
t(p)
t(t(p))
t(t(p)) %*% t(p)
p
install.packages("installr"); library(installr) # install+load installr
updateR() #
updateR()
dnorm(0)
pnorm(0)
pnorm(-1.67)
pnorm(1.67)
pnorm(1.64)
pnorm(-1.64)
install.packages("keras")
library(keras)
install_keras()
mnist <- dataset_mnist()
install_keras()
library(keras)
install_keras()
?getGEO
??getGEO
library(Biobase)
library(GEOquery)
install.packages("GEOquery")
BiocManager::install("GEOquery")
library(GEOquery)
?getGEO
?exprs
gset <- GEOquery::getGEO("GSE92767", GSEMatrix =TRUE, getGPL=FALSE)
gset <- GEOquery::getGEO("GSE42372", GSEMatrix =TRUE, getGPL=FALSE)
if (length(gset) > 1) idx <- grep("GPL13534", attr(gset, "names")) else idx <- 1
gset <- gset[[idx]]
?gset
data = exprs(gset)
?exprs
df[1,]
df = data.frame("Title" = NA,
"Decription" = NA,
"BiocVersion" = NA,
"Genome" = NA,
"SourceType" = NA,
"SourceUrl" = NA,
"SourceVersion" = NA,
"Species" = NA,
"TaxonomyId" = NA,
"Coordinate_1_based" = NA,
"DataProvider" = NA,
"Maintainer" = NA,
"RDataClass" = NA,
"DispatchClass" = NA,
"RDataPath" = NA,
"Tags" = NA,
"Notes" = NA)
df[1,]
dim(df)
c("Saliva", "Lymphoma", "Placenta", "Liver", "Colon", "Blood (Adults) - Peripheral Leukocytes", "Blood 5 year olds", "Blood newborns", "Cord-blood (whole blood)", "Cord-blood (PBMC)", "Adult (PBMC)", "Sperm"
rep(NA,17))
c("Saliva", "Lymphoma", "Placenta", "Liver", "Colon", "Blood (Adults) - Peripheral Leukocytes", "Blood 5 year olds", "Blood newborns", "Cord-blood (whole blood)", "Cord-blood (PBMC)", "Adult (PBMC)", "Sperm",
rep(NA,17))
date()
?date()
format(Sys.time(), "%a %b %d %H:%M:%S %Y")
format(Sys.time(), %b %d %H:%M:%S %Y")
format(Sys.time(), " %b %d %H:%M:%S %Y")
format(Sys.time(), "%b %d %Y")
c("Saliva", "Lymphoma", "Placenta", "Liver", "Colon", "Blood (Adults) - Peripheral Leukocytes", "Blood 5 year olds", "Blood newborns", "Cord-blood (whole blood)", "Cord-blood (PBMC)", "Adult (PBMC)", "Sperm",
rep(NA,17),
rep("3.9", 17),
rep("HM450k", 17),
rep(NA,17),
rep(NA,17),
rep(format(Sys.time(), "%b %d %Y"),17))
c("Saliva", "Lymphoma", "Placenta", "Liver", "Colon", "Blood (Adults) - Peripheral Leukocytes", "Blood 5 year olds", "Blood newborns", "Cord-blood (whole blood)", "Cord-blood (PBMC)", "Adult (PBMC)", "Sperm",
rep(NA,17),
rep("3.9", 17),
rep("HM450k", 17),
rep(NA,17),
rep(NA,17),
rep(format(Sys.time(), "%b %d %Y"),17),
rep("Homo sapiens",17),
rep(9606,17),
rep(NA,17),
rep(GEO,17),
rep(sgraw@kumc.edu,17),
rep(NA,17),
rep(NA,17),
rep(NA,17),
rep(NA,17),
rep(NA,17))
c("Saliva", "Lymphoma", "Placenta", "Liver", "Colon", "Blood (Adults) - Peripheral Leukocytes", "Blood 5 year olds", "Blood newborns", "Cord-blood (whole blood)", "Cord-blood (PBMC)", "Adult (PBMC)", "Sperm",
rep(NA,17),
rep("3.9", 17),
rep("HM450k", 17),
rep(NA,17),
rep(NA,17),
rep(format(Sys.time(), "%b %d %Y"),17),
rep("Homo sapiens",17),
rep(9606,17),
rep(NA,17),
rep("GEO",17),
rep("sgraw@kumc.edu",17),
rep(NA,17),
rep(NA,17),
rep(NA,17),
rep(NA,17),
rep(NA,17))
matrix(c("Saliva", "Lymphoma", "Placenta", "Liver", "Colon", "Blood (Adults) - Peripheral Leukocytes", "Blood 5 year olds", "Blood newborns", "Cord-blood (whole blood)", "Cord-blood (PBMC)", "Adult (PBMC)", "Sperm",
rep(NA,17),
rep("3.9", 17),
rep("HM450k", 17),
rep(NA,17),
rep(NA,17),
rep(format(Sys.time(), "%b %d %Y"),17),
rep("Homo sapiens",17),
rep(9606,17),
rep(NA,17),
rep("GEO",17),
rep("sgraw@kumc.edu",17),
rep(NA,17),
rep(NA,17),
rep(NA,17),
rep(NA,17),
rep(NA,17)),
nrow = F, ncol = 17
)
matrix(c("Saliva", "Lymphoma", "Placenta", "Liver", "Colon", "Blood (Adults) - Peripheral Leukocytes", "Blood 5 year olds", "Blood newborns", "Cord-blood (whole blood)", "Cord-blood (PBMC)", "Adult (PBMC)", "Sperm",
rep(NA,12),
rep("3.9", 12),
rep("HM450k", 12),
rep(NA,12),
rep(NA,12),
rep(format(Sys.time(), "%b %d %Y"),12),
rep("Homo sapiens",12),
rep(9606,12),
rep(NA,12),
rep("GEO",12),
rep("sgraw@kumc.edu",12),
rep(NA,12),
rep(NA,12),
rep(NA,12),
rep(NA,12),
rep(NA,12)),
nrow = F, ncol = 12
)
matrix(c("Saliva", "Lymphoma", "Placenta", "Liver", "Colon", "Blood (Adults) - Peripheral Leukocytes", "Blood 5 year olds", "Blood newborns", "Cord-blood (whole blood)", "Cord-blood (PBMC)", "Adult (PBMC)", "Sperm",
rep(NA,12),
rep("3.9", 12),
rep("HM450k", 12),
rep(NA,12),
rep(NA,12),
rep(format(Sys.time(), "%b %d %Y"),12),
rep("Homo sapiens",12),
rep(9606,12),
rep(NA,12),
rep("GEO",12),
rep("sgraw@kumc.edu",12),
rep(NA,12),
rep(NA,12),
rep(NA,12),
rep(NA,12),
rep(NA,12)),
nrow = F, ncol = 17, byrow = 12
)
matrix(c("Saliva", "Lymphoma", "Placenta", "Liver", "Colon", "Blood (Adults) - Peripheral Leukocytes", "Blood 5 year olds", "Blood newborns", "Cord-blood (whole blood)", "Cord-blood (PBMC)", "Adult (PBMC)", "Sperm",
rep(NA,17),
rep("3.9", 17),
rep("HM450k", 17),
rep(NA,17),
rep(NA,17),
rep(format(Sys.time(), "%b %d %Y"),17),
rep("Homo sapiens",17),
rep(9606,17),
rep(NA,17),
rep("GEO",17),
rep("sgraw@kumc.edu",17),
rep(NA,17),
rep(NA,17),
rep(NA,17),
rep(NA,17),
rep(NA,17)),
nrow = F, ncol = 17, byrow = 12
)
matrix(c("Saliva", "Lymphoma", "Placenta", "Liver", "Colon", "Blood (Adults) - Peripheral Leukocytes", "Blood 5 year olds", "Blood newborns", "Cord-blood (whole blood)", "Cord-blood (PBMC)", "Adult (PBMC)", "Sperm",
rep(NA,17),
rep("3.9", 17),
rep("HM450k", 17),
rep(NA,17),
rep(NA,17),
rep(format(Sys.time(), "%b %d %Y"),17),
rep("Homo sapiens",17),
rep(9606,17),
rep(NA,17),
rep("GEO",17),
rep("sgraw@kumc.edu",17),
rep(NA,17),
rep(NA,17),
rep(NA,17),
rep(NA,17),
rep(NA,17)),
nrow = 12, ncol = 17, byrow = F
)
matrix(c("Saliva", "Lymphoma", "Placenta", "Liver", "Colon", "Blood (Adults) - Peripheral Leukocytes", "Blood 5 year olds", "Blood newborns", "Cord-blood (whole blood)", "Cord-blood (PBMC)", "Adult (PBMC)", "Sperm",
rep(NA,12),
rep("3.9", 12),
rep("HM450k", 12),
rep(NA,12),
rep(NA,12),
rep(format(Sys.time(), "%b %d %Y"),12),
rep("Homo sapiens",12),
rep(9606,12),
rep(NA,12),
rep("GEO",12),
rep("sgraw@kumc.edu",12),
rep(NA,12),
rep(NA,12),
rep(NA,12),
rep(NA,12),
rep(NA,12)),
nrow = 12, ncol = 17, byrow = F
)
df = data.frame("Title" = NA,
"Decription" = NA,
"BiocVersion" = NA,
"Genome" = NA,
"SourceType" = NA,
"SourceUrl" = NA,
"SourceVersion" = NA,
"Species" = NA,
"TaxonomyId" = NA,
"Coordinate_1_based" = NA,
"DataProvider" = NA,
"Maintainer" = NA,
"RDataClass" = NA,
"DispatchClass" = NA,
"RDataPath" = NA,
"Tags" = NA,
"Notes" = NA)
df[1:12,] = matrix(c("Saliva", "Lymphoma", "Placenta", "Liver", "Colon", "Blood (Adults) - Peripheral Leukocytes", "Blood 5 year olds", "Blood newborns", "Cord-blood (whole blood)", "Cord-blood (PBMC)", "Adult (PBMC)", "Sperm",
rep(NA,12),
rep("3.9", 12),
rep("HM450k", 12),
rep(NA,12),
rep(NA,12),
rep(format(Sys.time(), "%b %d %Y"),12),
rep("Homo sapiens",12),
rep(9606,12),
rep(NA,12),
rep("GEO",12),
rep("sgraw@kumc.edu",12),
rep(NA,12),
rep(NA,12),
rep(NA,12),
rep(NA,12),
rep(NA,12)),
nrow = 12, ncol = 17, byrow = F
)
write.csv(df, file = "../extdata/metadata.csv", row.names=FALSE)
df[1:12,] = matrix(c("Saliva", "Lymphoma", "Placenta", "Liver", "Colon", "Blood (Adults) - Peripheral Leukocytes", "Blood 5 year olds", "Blood newborns", "Cord-blood (whole blood)", "Cord-blood (PBMC)", "Adult (PBMC)", "Sperm",
rep(NA,12),
rep("3.9", 12),
rep("HM450k", 12),
rep(NA,12),
rep(NA,12),
rep(format(Sys.time(), "%b %d %Y"),12),
rep("Homo sapiens",12),
rep(9606,12),
rep(NA,12),
rep("GEO",12),
rep("sgraw@kumc.edu",12),
rep(NA,12),
rep(NA,12),
rep(NA,12),
rep(NA,12),
rep(NA,12)),
nrow = 12, ncol = 17, byrow = F
)
df
getwd()
set.seed("D:\\PhD\\dissertation paper 1\\rcode\\pwrEWAS_data")
setwd("D:\\PhD\\dissertation paper 1\\rcode\\pwrEWAS_data")
write.csv(df, file = "../extdata/metadata.csv", row.names=FALSE)
setwd("D:\\PhD\\dissertation paper 1\\rcode\\pwrEWAS_data\\inst/scripts/")
write.csv(df, file = "../extdata/metadata.csv", row.names=FALSE)
q()
